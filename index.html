<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartStudy</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #fcfbf8;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Modo Oscuro */
        body.dark-mode {
            background: #1a1a1a;
            color: #f0f0f0;
        }

        body.dark-mode .login-container,
        body.dark-mode .course-card,
        body.dark-mode .header,
        body.dark-mode .course-header-nav {
            background: #242424;
            color: #f0f0f0;
        }

        body.dark-mode .logo-section h1,
        body.dark-mode .course-title-main,
        body.dark-mode .hero-title,
        body.dark-mode .course-title,
        body.dark-mode .topic-title,
        body.dark-mode .logo-text {
            color: #f0f0f0;
        }

        body.dark-mode .subtitle,
        body.dark-mode .hero-subtitle,
        body.dark-mode .course-description,
        body.dark-mode .topic-description,
        body.dark-mode .nav-link,
        body.dark-mode .breadcrumb {
            color: #aaa;
        }

        body.dark-mode .form-group input {
            background: #333;
            border-color: #444;
            color: #f0f0f0;
        }

        body.dark-mode .form-group input:focus {
            background: #3a3a3a;
            border-color: #f7b602;
        }

        body.dark-mode .form-group label {
            color: #f0f0f0;
        }

        body.dark-mode .tab {
            background: #333;
            color: #aaa;
        }

        body.dark-mode .tab:hover {
            background: #444;
        }

        body.dark-mode .course-footer {
            background: #2a2a2a;
        }

        body.dark-mode .theme-toggle,
        body.dark-mode .logout-btn {
            background: #333;
        }

        body.dark-mode .theme-toggle:hover,
        body.dark-mode .logout-btn:hover {
            background: #f7b602;
        }

        body.dark-mode .header,
        body.dark-mode .course-header-nav {
            border-bottom-color: #333;
        }

        body.dark-mode .top-nav {
            border-bottom-color: #333;
        }

        body.dark-mode .tabs-nav {
            border-bottom-color: #333;
        }

        body.dark-mode .btn-secondary {
            background: #333;
            border-color: #444;
            color: #f0f0f0;
        }

        body.dark-mode .btn-secondary:hover {
            border-color: #f7b602;
            color: #f7b602;
        }

        body.dark-mode .video-container {
            background: #333;
        }

        body.dark-mode .dropdown-content {
            background: #242424;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .dropdown-item {
            color: #aaa;
        }

        body.dark-mode .dropdown-item:hover {
            background: #f7b602;
            color: #1a1a1a;
        }

        body.dark-mode .course-card {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        body.dark-mode .course-card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .breadcrumb a {
            color: #f7b602;
        }

        /* ========== P√ÅGINA DE LOGIN ========== */
        .login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
        }

        .login-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            padding: 60px 50px;
            max-width: 500px;
            width: 100%;
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-section h1 {
            font-size: 48px;
            font-weight: 700;
            color: #2c2c2c;
            margin-bottom: 10px;
            letter-spacing: -1px;
        }

        .subtitle {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
            margin-top: 10px;
        }

        .role-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: #f5f5f5;
            color: #666;
            font-size: 16px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: #ffe8b3;
        }

        .tab.active {
            background: #f7b602;
            color: #2c2c2c;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            color: #2c2c2c;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e8e8e8;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .form-group input:focus {
            outline: none;
            border-color: #f7b602;
            background: white;
        }

        .submit-btn {
            width: 100%;
            padding: 18px;
            background: #f7b602;
            color: #2c2c2c;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .submit-btn:hover {
            background: #e5a600;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(247, 182, 2, 0.3);
        }

        #student-fields { display: block; }
        #admin-fields { display: none; }
       

        .error-message {
            background: #fee;
            color: #c33;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            font-size: 14px;
        }

        /* ========== DASHBOARD PAGE ========== */
        .dashboard-page {
            display: none;
            min-height: 100vh;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e5e5;
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: #f7b602;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text {
            font-size: 22px;

            font-weight: 700;
            color: #1a1a1a;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .theme-toggle, .logout-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f5f5;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }

        .theme-toggle:hover, .logout-btn:hover {
            background: #f7b602;
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 40px;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 80px;
        }

        .hero-title {
            font-size: 64px;
            font-weight: 900;
            color: #1a1a1a;
            margin-bottom: 20px;
            letter-spacing: -2px;
        }

        .hero-subtitle {
            font-size: 18px;
            color: #666;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .course-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .course-card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            transform: translateY(-4px);
        }

        .course-content {
            padding: 40px 32px;
        }

        .course-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .course-icon {
            width: 60px;
            height: 60px;
            background: rgba(247, 182, 2, 0.15);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
        }

        .course-title {
            font-size: 28px;
            font-weight: 700;
            color: #1a1a1a;
        }

        .course-description {
            color: #666;
            font-size: 15px;
            line-height: 1.6;
        }

        .course-footer {
            padding: 24px 32px;
            background: #fafafa;
        }

        .explore-btn {
            width: 100%;
            padding: 16px;
            background: #f7b602;
            color: #1a1a1a;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .explore-btn:hover {
            background: #e5a600;
        }

        /* ========== COURSE DETAIL PAGE ========== */
        .course-detail-page {
            display: none;
            min-height: 100vh;
        }

        .course-header-nav {
            background: white;
            border-bottom: 1px solid #e5e5e5;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }

        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #e5e5e5;
        }

        .nav-links {
            display: flex;
            gap: 32px;
        }

        .nav-link {
            color: #666;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            color: #f7b602;
        }

        /* Dropdown de cursos */
        .courses-dropdown {
            position: relative;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            margin-top: 0;
    		transform: none;
            z-index: 1000;
        }

		/* .courses-dropdown:hover .dropdown-content,
		.courses-dropdown:focus-within .dropdown-content {
    		display: block;
		}
		*/

        .dropdown-item {
            padding: 12px 20px;
            color: #666;
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .dropdown-item:hover {
            background: #f7b602;
            color: #1a1a1a;
        }

        .dropdown-item:first-child {
            border-radius: 8px 8px 0 0;
        }

        .dropdown-item:last-child {
            border-radius: 0 0 8px 8px;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f7b602;
        }

        .breadcrumb {
            padding: 20px 0;
            color: #999;
            font-size: 14px;
        }

        .breadcrumb a {
            color: #f7b602;
            text-decoration: none;
        }

        .course-detail-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 40px 80px;
        }

        .course-title-main {
            font-size: 48px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 30px;
        }

        .tabs-nav {
            display: flex;
            gap: 32px;
            border-bottom: 2px solid #e5e5e5;
            margin-bottom: 40px;
        }

        .tab-link {
            padding: 12px 0;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-link.active {
            color: #f7b602;
            border-bottom-color: #f7b602;
        }

        .topic-section {
            margin-bottom: 60px;
        }

        .topic-title {
            font-size: 24px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 20px;
        }

        .video-container {
            width: 100%;
            aspect-ratio: 16/9;
            background: #e5e5e5;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }

        .video-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: #666;
        }

        .topic-description {
            color: #666;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 16px;
        }

        .btn-primary {
            flex: 1;
            padding: 14px 24px;
            background: #f7b602;
            color: #1a1a1a;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: #e5a600;
        }

        .btn-secondary {
            flex: 1;
            padding: 14px 24px;
            background: white;
            color: #1a1a1a;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            border-color: #f7b602;
            color: #f7b602;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 42px;
            }
            .courses-grid {
                grid-template-columns: 1fr;
            }
            .main-content, .course-detail-content {
                padding: 40px 20px;
            }
            .action-buttons {
                flex-direction: column;
            }
        }
    
        /* Support embedded iframes inside video cards */
        .video-container iframe {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            border: 0;
            border-radius: 12px;
        }

/* === Admin Actions Menu === */
.admin-actions-menu{ position:relative; display:none; }
.admin-actions-menu .actions-btn{
  display:flex; align-items:center; gap:6px;
  padding:10px 12px; border-radius:999px; border:0; cursor:pointer;
  font-weight:700; background:#f5f5f5; color:#1a1a1a; transition:.25s;
}
.admin-actions-menu .actions-btn:hover{ background:#f7b602; color:#1a1a1a; transform:translateY(-1px); }

.admin-actions-menu .actions-dropdown{
  position:absolute; top:110%; right:0; min-width:220px;
  background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.15);
  padding:6px 0; display:none; z-index:1200;
}
.admin-actions-menu:hover .actions-dropdown{ display:block; }

.admin-actions-menu .actions-dropdown a,
.admin-actions-menu .actions-dropdown .submenu > span{
  display:flex; justify-content:space-between; align-items:center;
  gap:10px; padding:10px 14px; color:#444; text-decoration:none; cursor:pointer;
}
.admin-actions-menu .actions-dropdown a:hover,
.admin-actions-menu .actions-dropdown .submenu > span:hover{
  background:#f7b602; color:#1a1a1a;
}

/* Submen√∫ lateral */
.admin-actions-menu .submenu{ position:relative; }
.admin-actions-menu .submenu-content{
  position:absolute; top:0; left:100%; min-width:220px; display:none;
  background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.15);
  padding:6px 0;
}
.admin-actions-menu .submenu:hover .submenu-content{ display:block; }

/* Dark mode */
body.dark-mode .admin-actions-menu .actions-btn{ background:#333; color:#eee; }
body.dark-mode .admin-actions-menu .actions-btn:hover{ background:#f7b602; color:#1a1a1a; }
body.dark-mode .admin-actions-menu .actions-dropdown,
body.dark-mode .admin-actions-menu .submenu-content{
  background:#242424; box-shadow:0 10px 30px rgba(0,0,0,.5);
}
body.dark-mode .admin-actions-menu .actions-dropdown a,
body.dark-mode .admin-actions-menu .actions-dropdown .submenu > span{ color:#ddd; }
body.dark-mode .admin-actions-menu .actions-dropdown a:hover,
body.dark-mode .admin-actions-menu .actions-dropdown .submenu > span:hover{
  background:#f7b602; color:#1a1a1a;
}
</style>

    <!-- MathJax for rendering LaTeX equations -->
    <script>
      MathJax = {
        tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

	<script>
	document.addEventListener('DOMContentLoaded', () => {
	  const dropdown = document.querySelector('.courses-dropdown');
	  const menu = dropdown.querySelector('.dropdown-content');
	  const trigger = dropdown.querySelector('.nav-link');

	  // Alterna visibilidad al hacer clic
	  trigger.addEventListener('click', (e) => {
		e.preventDefault();
		menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
	  });

	  // Cierra el men√∫ si el mouse sale del √°rea del dropdown
	  menu.addEventListener('mouseleave', () => {
		menu.style.display = 'none';
	  });

	  // Tambi√©n cierra si se hace clic fuera del men√∫
	  document.addEventListener('click', (e) => {
		if (!dropdown.contains(e.target)) {
		  menu.style.display = 'none';
		}
	  });
	});
	</script>

		

<style id="quiz-styles">
/* === Autoevaluaci√≥n (modal tipo chat) === */
#quiz-modal {
  position: fixed; inset: 0; display: none; align-items: center; justify-content: center;
  background: rgba(0,0,0,.35); z-index: 9999; padding: 1rem;
}
#quiz-modal .quiz-card {
  width: min(860px, 100%); max-height: 90vh; overflow: hidden; border-radius: 16px;
  background: #fff; color: #111; box-shadow: 0 10px 30px rgba(0,0,0,.25);
  display: grid; grid-template-rows: auto 1fr auto;
}
body.dark-mode #quiz-modal .quiz-card { background: #1f1f1f; color: #eee; }
.quiz-header { display:flex; align-items:center; justify-content: space-between; padding: 14px 18px; border-bottom: 1px solid rgba(0,0,0,.08); }
body.dark-mode .quiz-header { border-color: rgba(255,255,255,.08); }
.quiz-title { font-weight: 700; font-size: 1.05rem; }
.quiz-close { border:0; background: transparent; font-size: 1.4rem; line-height:1; cursor:pointer; color: inherit; }
.quiz-body { overflow: auto; padding: 18px; display:flex; flex-direction: column; gap: 14px; }
.quiz-footer { padding: 14px 18px; display:flex; gap:10px; border-top: 1px solid rgba(0,0,0,.08); justify-content: flex-end; flex-wrap: wrap; }
body.dark-mode .quiz-footer { border-color: rgba(255,255,255,.08); }
.quiz-question { border:1px solid rgba(0,0,0,.08); border-radius: 12px; padding:14px }
body.dark-mode .quiz-question { border-color: rgba(255,255,255,.08); }
.quiz-question h4 { margin-bottom: 8px; font-size: 1rem; }
.quiz-options { display: grid; gap:8px; margin-top: 8px; }
.quiz-option { display:flex; gap:10px; align-items:flex-start; }
.quiz-badge { display:inline-flex; align-items:center; gap:6px; font-size:.8rem; padding:4px 8px; border-radius:999px; border:1px solid rgba(0,0,0,.1); }
body.dark-mode .quiz-badge{ border-color: rgba(255,255,255,.1); }
.quiz-summary { border:1px dashed rgba(0,0,0,.15); border-radius: 12px; padding: 14px; }
.quiz-summary h4 { margin-bottom: 8px; }
.btn-quiz { padding:10px 14px; border-radius: 10px; border: 1px solid transparent; cursor:pointer; font-weight:600; }
.btn-quiz.primary { background:#056e6e; color:#fff; }
.btn-quiz.secondary { background:#e5e7eb; }
body.dark-mode .btn-quiz.secondary { background:#333; color:#ddd; }
.btn-quiz.ghost { background: transparent; border-color: rgba(0,0,0,.15); }
body.dark-mode .btn-quiz.ghost { border-color: rgba(255,255,255,.15); color:#ddd; }
.quiz-feedback { font-size:.9rem; opacity:.9; margin-top:6px; }
.correct { color: #16a34a; }
.incorrect { color: #dc2626; }
.muted { opacity: .8; }
.katex, .MathJax { font-size: 1.05em; }
</style>


<!-- === SmartStudy Google Apps Script API Config (auto-insert) === -->
<script>
window.SS_currentUser = window.SS_currentUser || { code: "", name: "", course: "" };
const GAS_ENDPOINT_SMART = "https://script.google.com/macros/s/AKfycbzbBt7dCl7udShr9KUNcMD8VFeYOY0xIyxJO-0PU80PRMtzAj-xjysswnYCtZvDiCHe/exec";
const GAS_TOKEN_SMART = "SmartStudy_2025_SECURE_1978";

async function SS_logToGAS({ code, name = "", course = "", event = "" }) {
  try {
    const payload = new URLSearchParams({
      token: GAS_TOKEN_SMART,
      code,
      name,
      course,
      userAgent: navigator.userAgent,
      timestamp: new Date().toISOString(),
      event
    });
    await fetch(GAS_ENDPOINT_SMART, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" },
      body: payload.toString()
    });
  } catch (err) {
    console.error("Error enviando datos a Google Apps Script (SmartStudy):", err);
  }
}

function SS_track(event, extra = {
}) {
  try {
    window.SS_currentUser = window.SS_currentUser || { code: "", name: "", course: "" };
    SS_logToGAS({
      code: SS_currentUser.code || "",
      name: SS_currentUser.name || "",
      course: extra.course || SS_currentUser.course || "",
      event
    });
  } catch(e) {
    console.warn("No se pudo registrar el evento:", event, e);
  }
}
</script>

</head>
<body>
    <!-- ========== LOGIN PAGE ========== -->
    <div class="login-page" id="login-page">
        <div class="login-container">
            <div class="logo-section">
                <img src="Logo.png" width="256" height="256" alt=""/>
				<h1>SmartStudy</h1>
				<p class="subtitle">Bienvenido a Smart Study, un espacio para aprender, practicar y comprender la ciencia de forma clara y sencilla</p>
            </div>
            <div class="role-tabs">
                <button class="tab active" id="student-tab">Estudiante</button>
				<button class="tab" id="admin-tab">Administrador</button>
            </div>
            <div class="error-message" id="error-message"></div>
            <form id="login-form">
                <div id="student-fields">
                    <div class="form-group">
                        <label for="student-name">Nombre Completo</label>
                        <input type="text" id="student-name" placeholder="Ingresa tu nombre">
                    </div>
                    <div class="form-group">
                        <label for="student-code">C√≥digo de Estudiante</label>
                        <input type="text" id="student-code" placeholder="Ingresa tu c√≥digo N000XXXXXX">
                    </div>
                </div>
				<div id="admin-fields">
                    <div class="form-group">
                        <label for="admin-email">Correo</label>
                        <input type="email" id="admin-email" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="admin-password">Contrase√±a</label>
                        <input type="password" id="admin-password" placeholder="Enter your password">
                    </div>
                </div>
               <button type="submit" class="submit-btn">Iniciar Sesi√≥n</button>
            </form>
        </div>
    </div>

    <!-- ========== DASHBOARD PAGE ========== -->
    <div class="dashboard-page" id="dashboard-page">
        <header class="header">
            <div class="header-content">
                <div class="logo-header">
                    <div class="logo-icon"><img src="Logo.png" width="24" height="24" alt=""/></div>
                    <span class="logo-text">SmartStudy</span>
                </div>
                <div class="header-right">
                    <!-- Men√∫ principal de administrador (Dashboard) -->
                    <div class="admin-actions-menu">
                      <button class="actions-btn">‚öôÔ∏è Acciones ‚ñæ</button>
                      <div class="actions-dropdown">
                        <a data-link="actividad" href="#" target="_blank" rel="noopener">Actividad</a>
                        <div class="submenu">
                          <span>Resultados ‚ñ∏</span>
                          <div class="submenu-content">
                            <a data-link="mate" href="#" target="_blank" rel="noopener">Matem√°tica</a>
                            <a data-link="fisi" href="#" target="_blank" rel="noopener">F√≠sica</a>
                            <a data-link="quim" href="#" target="_blank" rel="noopener">Qu√≠mica</a>
                          </div>
                        </div>
                      </div>
                    </div>

                    <button class="theme-toggle"><img src="claro.png" width="32" height="32" alt=""/></button>
                    <button class="logout-btn" onclick="logout()" title="Cerrar Sesi√≥n"><img src="salir.png" width="32" height="32" alt=""/></button>
                </div>
            </div>
        </header>
        <main class="main-content">
            <div class="hero-section">
                <h2 class="hero-title">Explora y Aprende</h2>
                <p class="hero-subtitle">En esta secci√≥n puedes acceder a los recursos de Matem√°tica, F√≠sica y Qu√≠mica, con videos explicativos, autoevaluaciones interactivas y el apoyo de tu tutor IA, que te acompa√±a paso a paso para comprender y aplicar cada concepto en la ingenier√≠a y la vida real.</p>
            </div>
			
		
            <div class="courses-grid">
                <div class="course-card">
                    <div class="course-content">
                        <div class="course-header">
                            <div class="course-icon"><img src="Mate.png" width="48" height="48" alt=""/></div>
                            <h3 class="course-title">Matem√°ticas</h3>
                        </div>
                        <p class="course-description">Domina las ideas clave de las matem√°ticas y descubre c√≥mo aplicarlas para resolver retos reales. Aprende a interpretar, calcular y modelar situaciones cotidianas y de ingenier√≠a con confianza, claridad y sentido pr√°ctico.</p>
                    </div>
                    <div class="course-footer">
                        <button class="explore-btn" onclick="showCourse('matematicas')">
                            <span>Explorar Curso</span>
                            <span>‚Üí</span>
                        </button>
                    </div>
                </div>
                <div class="course-card">
                    <div class="course-content">
                        <div class="course-header">
                            <div class="course-icon"><img src="Fisi.png" width="46" height="46" alt=""/></div>
                            <h3 class="course-title">F√≠sica</h3>
                        </div>
                        <p class="course-description">Descubre las leyes que dan forma al mundo y entiende c√≥mo influyen en lo que ves cada d√≠a. Comprende el movimiento, la energ√≠a y las fuerzas que hacen posible la tecnolog√≠a y la ingenier√≠a moderna.</p>
                    </div>
                    <div class="course-footer">
                        <button class="explore-btn" onclick="showCourse('fisica')">
                            <span>Explorar Curso</span>
                            <span>‚Üí</span>
                        </button>
                    </div>
                </div>
                <div class="course-card">
                    <div class="course-content">
                        <div class="course-header">
                            <div class="course-icon"><img src="Quim.png" width="48" height="48" alt=""/></div>
                            <h3 class="course-title">Qu√≠mica</h3>
                        </div>
                        <p class="course-description">Explora la materia desde una mirada curiosa y aplicada. Comprende c√≥mo ocurren las transformaciones que sustentan la vida, la industria y la ingenier√≠a, conectando la ciencia con lo que usas y ves a diario.</p>
                    </div>
                    <div class="course-footer">
                        <button class="explore-btn" onclick="showCourse('quimica')">
                            <span>Explorar Curso</span>
                            <span>‚Üí</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>
	

    <!-- ========== COURSE DETAIL PAGE ========== -->
    <div class="course-detail-page" id="course-detail-page">
        <header class="course-header-nav">
            <div class="nav-container">
                <div class="top-nav">
                    <div class="logo-header">
                        <div class="logo-icon"><img src="Logo.png" width="24" height="24" alt=""/></div>
                        <span class="logo-text">SmartStudy</span>
                    </div>
                    <div class="nav-links">
                        <a href="#" class="nav-link" onclick="backToDashboard(); return false;">Inicio</a>
                        <div class="courses-dropdown">
                            <a href="#" class="nav-link" style="color: #f7b602;">Cursos ‚ñæ</a>
                            <div class="dropdown-content">
                                <div class="dropdown-item" onclick="showCourse('matematicas')"><img src="Mate.png" width="13" height="13" alt=""/> Matem√°ticas</div>
                                <div class="dropdown-item" onclick="showCourse('fisica')"><img src="Fisi.png" width="12" height="12" alt=""/> F√≠sica</div>
                                <div class="dropdown-item" onclick="showCourse('quimica')"><img src="Quim.png" width="13" height="13" alt=""/> Qu√≠mica</div>
                            </div>
                        </div>
                    </div>
                    <div class="user-section">
                        <!-- Men√∫ Acciones (solo admin) en p√°gina de curso -->
                        <div class="admin-actions-menu">
                          <button class="actions-btn">‚öôÔ∏è Acciones ‚ñæ</button>
                          <div class="actions-dropdown">
                            <a data-link="actividad" href="#" target="_blank" rel="noopener">Actividad</a>
                            <div class="submenu">
                              <span>Resultados ‚ñ∏</span>
                              <div class="submenu-content">
                                <a data-link="mate" href="#" target="_blank" rel="noopener">Matem√°tica</a>
                                <a data-link="fisi" href="#" target="_blank" rel="noopener">F√≠sica</a>
                                <a data-link="quim" href="#" target="_blank" rel="noopener">Qu√≠mica</a>
                              </div>
                            </div>
                          </div>
                        </div>

                        <button class="theme-toggle"><img src="claro.png" width="32" height="32" alt=""/></button>
                        <button class="logout-btn" onclick="logout()" title="Cerrar Sesi√≥n"><img src="salir.png" width="32" height="32" alt=""/></button>
                    </div>
                </div>
                <div class="breadcrumb">
                    <a href="#" onclick="backToDashboard()">Cursos</a> / <span id="course-name-breadcrumb">Matem√°tica</span>
                </div>
            </div>
        </header>
        <main class="course-detail-content">
            <h1 class="course-title-main" id="course-name-title">Matem√°tica</h1>
            <div class="tabs-nav">
                <div class="tab-link active">Temas</div>
            </div>
            
            <div id="course-topics"></div>
        </main>
    </div>

    <script>
        // Credenciales
        const adminCredentials = [
            { email: 'julian.diaz@upn.edu.pe', password: 'Docente_quim2025', course: 'Qu√≠mica', name: 'Julian Ricardo Diaz Ruiz' },
            { email: 'luis.carmona@upn.edu.pe', password: 'Docente_mate2025', course: 'Matem√°tica', name: 'Luis Alberto Carmona Castrejon' },
            { email: 'yamil.minez@upn.edu.pe', password: 'Docente_fisi2025', course: 'F√≠sica', name: 'Yamil Zenefelder Minez Cuba' }
        ];

        // Contenido de los cursos
        const coursesContent = {
            matematicas: {
                name: 'Matem√°tica',
                topics: [
                    {
                        title: 'Suma de Funciones',
                        iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/7ga65jt1xOg?si=wDEw7-adRxXhDKh-" title="Suma de Funciones" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
                        description: `La suma de funciones combina dos funciones $f$ y $g$ sumando sus valores:
                        $$ (f + g)(x) = f(x) + g(x) $$
                        <br><b>Ejemplo:</b> si $f(x) = 2x + 1$ y $g(x) = x^2$, entonces
                        $$ (f + g)(x) = x^2 + 2x + 1. $$
                        El dominio de $(f+g)$ es la intersecci√≥n de los dominios de $f$ y $g$.
						<br>1Ô∏è‚É£ Solo est√° definida donde ambas funciones existen.
						<br>2Ô∏è‚É£ Si $ùëì$ y $ùëî$ son continuas, su suma tambi√©n lo ser√°.
						<br>3Ô∏è‚É£ √ötil para modelar procesos que se combinan (por ejemplo, fuerzas o costos).`
                    },
                    {
                        title: 'Resta de Funciones',
                        iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/3poB1pM11dM?si=AXX20eBGUBUrADcD" title="Resta de Funciones" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
                        description: `La resta de funciones se define como
                        $$ (f - g)(x) = f(x) - g(x). $$
                        <br><b>Ejemplo:</b> si $f(x) = x^2 + 2x$ y $g(x) = x + 1$, entonces
                        $$ (f - g)(x) = x^2 + x - 1. $$
						En el dominio de la resta $(f ‚àí g)$, los conjuntos se intersectan, no se unen.
						<br>1Ô∏è‚É£ Igual que en la suma, ambas deben estar definidas en $ùë•$.
						<br>2Ô∏è‚É£ Afecta la forma gr√°fica desplazando o invirtiendo zonas seg√∫n los signos.
						<br>3Ô∏è‚É£ Puede representar diferencias de magnitudes o tasas.`
                    },
                    {
                        title: 'Multiplicaci√≥n de Funciones',
                        iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/qJkRXOaatpc?si=6M2SrL1TgRNQhNdv" title="Multiplicaci√≥n de Funciones" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
                        description: `La multiplicaci√≥n de funciones:
                        $$ (f \\cdot g)(x) = f(x) \\cdot g(x). $$
                        <br><b>Ejemplo:</b> si $f(x) = x - 2$ y $g(x) = \\sqrt{x}$, entonces
                        $$ (f\\cdot g)(x) = (x - 2)\\sqrt{x}, \\quad x \\ge 0. $$
						Intersecci√≥n de los dominios de $ùëì$ y $ùëî$.
						<br>1Ô∏è‚É£ Si una funci√≥n vale 0 en un punto, el producto tambi√©n ser√° 0.
						<br>2Ô∏è‚É£ Si ambas son continuas, su producto tambi√©n lo ser√°.
						<br>3Ô∏è‚É£ Puede alterar la amplitud y el signo del resultado.`
						
                    },
                    {
                        title: 'Divisi√≥n de Funciones',
                        iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/iql2R3LzaKU?si=VxdeMq9oZysO-Bpa" title="Divisi√≥n de Funciones" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
                        description: `La divisi√≥n de funciones:
                        $$ \\left( \\frac{f}{g} \\right)(x) = \\frac{f(x)}{g(x)}, \\quad g(x) \\ne 0. $$
                        <br><b>Ejemplo:</b> si $f(x) = x^2 - 1$ y $g(x) = x - 1$, entonces
                        $$ \\frac{f(x)}{g(x)} = \\frac{x^2 - 1}{x - 1} = x + 1, \\quad x \\ne 1. $$
						‚ö†Ô∏è No est√° definida cuando $ùëî(ùë•)=0$. Si $ùëî(ùë•)$ se acerca a 0, puede haber <b>as√≠ntotas verticales</b>.
						La continuidad depende de que $ùëî(ùë•)‚â†0$ en el intervalo.`
                    },
                    {
                        title: 'Dominio y Rango de Funciones',
                        iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/u9FR4le6xBY?si=8rPb3cb58pQLOkS0" title="Dominio y Rango de Funciones" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
                        description: `El <b>dominio</b> es el conjunto de valores de $x$ para los que $f(x)$ est√° definida; el <b>rango</b> es el conjunto de valores de $f(x)$. 
                        <br><b>Ejemplo:</b> si $f(x) = \\sqrt{x - 1}$, entonces
                        $$ \\text{Dom}(f) = [1, \\infty), \\qquad \\text{Ran}(f) = [0, \\infty). $$
						<br><b>El rango</b> (tambi√©n llamado imagen de la funci√≥n) es el conjunto de valores que realmente toma la funci√≥n al evaluar todas las $ùë•$ posibles de su dominio.
						<br>En otras palabras:
						<br>$Rango(f)={f(x)‚à£x‚ààDom(f)}$`
                    }
                ]
            },

            fisica: {
			  name: 'F√≠sica',
			  topics: [
				{
				  title: 'Momento de fuerza o torque',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/3QMrevISKR4?si=P-gH5bUZb89jvNdW" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  El <b>torque</b> o <b>momento de fuerza</b> mide la tendencia de una fuerza a provocar rotaci√≥n alrededor de un punto o eje.  
				  Se define como el producto vectorial entre el vector posici√≥n y la fuerza aplicada:
				  $$ \\vec{\\tau} = \\vec{r} \\times \\vec{F}, \\quad \\tau = r F \\sin\\theta. $$
				  Donde:
				  <br>- $r$ es la distancia desde el eje de rotaci√≥n hasta el punto de aplicaci√≥n de la fuerza,
				  <br>- $F$ es la magnitud de la fuerza,
				  <br>- $\\theta$ el √°ngulo entre ambos vectores.

				  <br>Cuanto mayor sea la distancia o la fuerza, mayor ser√° el torque.  
				  <br><b>Ejemplo:</b> una llave de $r=0.25\\,\\text{m}$ con una fuerza de $80\\,\\text{N}$ perpendicular genera:
				  $$ \\tau = 0.25 \\times 80 = 20\\,\\text{N¬∑m}. $$
				  <br>El sentido del giro se determina con la regla de la mano derecha.
				  `
				},
				{
				  title: 'Segunda condici√≥n de equilibrio',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/kpqs7nvECiE?si=peRq_OgMfRaGUycE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  Un cuerpo r√≠gido est√° en equilibrio rotacional cuando la suma de todos los torques es nula:
				  $$ \\sum \\tau = 0. $$
				  Esto implica que no hay rotaci√≥n neta.  
				  Si adem√°s se cumple el equilibrio traslacional:
				  $$ \\sum \\vec{F} = \\vec{0}, $$
				  entonces el cuerpo se encuentra en <b>equilibrio total</b> (sin moverse ni rotar).

				  En problemas pr√°cticos, se elige un punto de referencia (pivote) y se aplican ambas condiciones para determinar fuerzas desconocidas.
				  `
				},
				{
				  title: 'Ejercicio: segunda condici√≥n de equilibrio',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/0miNZl99ME8?si=V07SuaJK7YLUQmD7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  <b>Paso a paso:</b>
				  <br>1Ô∏è‚É£ Dibuja el <b>diagrama de cuerpo libre</b> con todas las fuerzas.  
				  <br>2Ô∏è‚É£ Elige un punto de giro donde aplicar $\\sum \\tau = 0$ (preferiblemente uno donde act√∫e una fuerza desconocida para eliminarla).  
				  <br>3Ô∏è‚É£ Sustituye las fuerzas y distancias perpendiculares:  
				  $$ F_1 d_1 = F_2 d_2. $$  
				  <br>4Ô∏è‚É£ Resuelve para la fuerza o distancia buscada.

				  <br>Este procedimiento permite comprender c√≥mo las fuerzas pueden compensarse para mantener el equilibrio.
				  `
				},
				{
				  title: 'Equilibrio total de cuerpos r√≠gidos',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/yOF8i8rS1EI?si=cbxD1AbB8vTKxWTQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  Un cuerpo est√° en <b>equilibrio total</b> si se cumplen simult√°neamente las dos condiciones:
				  $$ \\sum \\vec{F} = \\vec{0}, \\qquad \\sum \\tau = 0. $$
				  La primera evita movimientos lineales; la segunda evita rotaciones.

				  Ejemplo t√≠pico: una viga sostenida por dos apoyos que equilibra su propio peso y el de cargas adicionales.
				  Estos principios son la base del dise√±o estructural y el an√°lisis de sistemas est√°ticos.
				  `
				},
				{
				  title: 'Ejercicio de equilibrio total',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/MZfeRlxhaZQ?si=B5Bbz2Mrdt6Scrlz" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  <b>Ejemplo:</b>  
				  Una viga horizontal de longitud $L$ y peso propio $W$ est√° apoyada en los extremos A y B.  
				  Condiciones de equilibrio:
				  $$ R_A + R_B = W, $$
				  y tomando momentos respecto de A:
				  $$ R_B L = W \\frac{L}{2} \\Rightarrow R_B = \\frac{W}{2}, \\quad R_A = \\frac{W}{2}. $$

				  De esta manera, ambas reacciones se reparten el peso de forma equilibrada.  
				  El razonamiento es id√©ntico para puentes, gr√∫as o estructuras est√°ticas reales.
				  `
				}
			  ]
			},
			quimica: {
			  name: 'Qu√≠mica',
			  topics: [
				{
				  title: 'Leyes Ponderales ‚Äì Ley de Lavoisier',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/stUIYf17FwM?si=_QCX0VMIw-4u1_iA" title="Ley de Lavoisier" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  La <b>Ley de Lavoisier</b> establece que en toda reacci√≥n qu√≠mica, la masa total de los reactivos es igual a la masa total de los productos:
				  $$ m_{\\text{reactivos}} = m_{\\text{productos}}. $$
				  Esto significa que la materia no se crea ni se destruye, solo se transforma.  

				  <b>Ejemplo:</b>  
				  Cuando el hidr√≥geno y el ox√≠geno reaccionan para formar agua:
				  $$ 2\\,\\mathrm{H_2} + \\mathrm{O_2} \\rightarrow 2\\,\\mathrm{H_2O}, $$
				  las masas cumplen:
				  $$ 2(2) + 32 = 36\\,\\text{g de reactivos} = 36\\,\\text{g de productos}. $$
				  `
				},
				{
				  title: 'Leyes Ponderales ‚Äì Ley de Dalton (proporciones m√∫ltiples)',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/TVtt9zwVOgA?si=oWuCaIWEV9PXGWX-" title="Ley de Dalton" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  La <b>Ley de Dalton</b> afirma que si dos elementos se combinan de distintas maneras para formar varios compuestos,
				  las masas de uno que se combinan con una cantidad fija del otro est√°n en proporciones de n√∫meros enteros peque√±os.

				  <b>Ejemplo:</b>  
				  El carbono y el ox√≠geno forman:
				  - Mon√≥xido de carbono (CO): 12 g de C con 16 g de O.  
				  - Di√≥xido de carbono (CO‚ÇÇ): 12 g de C con 32 g de O.  
				  La proporci√≥n de masas de O en ambos compuestos es $16:32 = 1:2$, un n√∫mero entero simple.
				  `
				},
				{
				  title: 'Leyes Ponderales ‚Äì Ley de Proust (proporciones definidas)',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/WnzCl-EJkiU?si=y90-xJe3v686UHHD" title="Ley de Proust" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  La <b>Ley de Proust</b> indica que un compuesto puro siempre tiene la misma proporci√≥n en masa de sus elementos,
				  sin importar su origen o m√©todo de obtenci√≥n.  

				  <b>Ejemplo:</b>  
				  En el agua ($\\mathrm{H_2O}$), la relaci√≥n de masas entre hidr√≥geno y ox√≠geno siempre es:
				  $$ \\frac{m_{\\text H}}{m_{\\text O}} = \\frac{2\\times1}{16} = \\frac{1}{8}. $$
				  Por tanto, 1 g de hidr√≥geno se combina siempre con 8 g de ox√≠geno para formar agua.
				  `
				},
				{
				  title: 'Reactivo limitante y en exceso',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/Th_epvvGUx8?si=Z1QJfcmn9_sIsR88" title="Reactivo limitante y en exceso" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  En una reacci√≥n qu√≠mica, el <b>reactivo limitante</b> es el que se consume primero y determina la cantidad m√°xima de producto que puede formarse.  
				  El <b>reactivo en exceso</b> queda parcialmente sin reaccionar.  

				  <b>Paso a paso:</b>  
				  1Ô∏è‚É£ Calcula los moles de cada reactivo: $n = m/M$.  
				  2Ô∏è‚É£ Divide los moles entre sus coeficientes estequiom√©tricos.  
				  3Ô∏è‚É£ El menor resultado indica el reactivo limitante.  

				  <b>Ejemplo:</b>  
				  $$ \\mathrm{2H_2 + O_2 \\to 2H_2O} $$  
				  Si tienes 4 mol de $\\mathrm{H_2}$ y 3 mol de $\\mathrm{O_2}$:  
				  $\\frac{4}{2}=2$, $\\frac{3}{1}=3$ ‚Üí el menor valor es 2 ‚Üí $\\mathrm{H_2}$ es el limitante.
				  `
				},
				{
				  title: 'Ejercicio ‚Äì Leyes Ponderales',
				  iframe: `<iframe width="560" height="315" src="https://www.youtube.com/embed/5_GeOnBtlOQ?si=hjv9mGEySdHcouo3" title="Ejercicio Leyes Ponderales" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`,
				  description: `
				  En este ejercicio se aplican las tres leyes ponderales para analizar masas de reactivos y productos.  
				  Se espera que el estudiante identifique la ley correspondiente, compruebe las proporciones y determine la coherencia de los datos experimentales.

				  <b>Recomendaci√≥n:</b> redondear las masas con dos decimales y justificar si los resultados confirman o no la ley evaluada.
				  `
				}
			  ]
			},
        };

		const tutorLinks = {
		  matematicas: 'https://chatgpt.com/g/g-68fc391210cc8191a8b3a4e104e67c03-nexa',
		  fisica: 'https://chatgpt.com/g/g-682b57c92b208191b5add667cb74e058-neutrino',
		  quimica: 'https://chatgpt.com/g/g-I55tWh9Vc-taxonomia-de-bloom'
		};

		
		
        let currentRole = 'student';

        // Login handlers
        document.getElementById('admin-tab').addEventListener('click', () => {
            document.getElementById('admin-tab').classList.add('active');
            document.getElementById('student-tab').classList.remove('active');
            document.getElementById('admin-fields').style.display = 'block';
            document.getElementById('student-fields').style.display = 'none';
            currentRole = 'admin';
        });

        document.getElementById('student-tab').addEventListener('click', () => {
            document.getElementById('student-tab').classList.add('active');
            document.getElementById('admin-tab').classList.remove('active');
            document.getElementById('student-fields').style.display = 'block';
            document.getElementById('admin-fields').style.display = 'none';
            currentRole = 'student';
        });

        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const errorMessage = document.getElementById('error-message');

            if (currentRole === 'admin') {
                const email = document.getElementById('admin-email').value;
                const password = document.getElementById('admin-password').value;
                const admin = adminCredentials.find(c => c.email === email && c.password === password);

                if (admin) {
                    document.getElementById('login-page').style.display = 'none';
                    document.getElementById('dashboard-page').style.display = 'block';
                } else {
                    errorMessage.textContent = 'Correo o contrase√±a incorrectos';
                    errorMessage.style.display = 'block';
                    setTimeout(() => errorMessage.style.display = 'none', 3000);
                }
            } else {
                const name = document.getElementById('student-name').value.trim();
                const code = document.getElementById('student-code').value.trim();

                if (name && code) {
                    document.getElementById('login-page').style.display = 'none';
                    document.getElementById('dashboard-page').style.display = 'block';
                } else {
                    errorMessage.textContent = 'Por favor completa todos los campos';
                    errorMessage.style.display = 'block';
                    setTimeout(() => errorMessage.style.display = 'none', 3000);
                }
            }
        });

        // Mostrar curso
        function showCourse(courseId) {
            const course = coursesContent[courseId];
            document.getElementById('dashboard-page').style.display = 'none';
            document.getElementById('course-detail-page').style.display = 'block';
            document.getElementById('course-name-breadcrumb').textContent = course.name;
            document.getElementById('course-name-title').textContent = course.name;

            const topicsContainer = document.getElementById('course-topics');
            topicsContainer.innerHTML = course.topics.map(topic => `
                <div class="topic-section">
                    <h2 class="topic-title">${topic.title}</h2>
                    <div class="video-container">
                        ${topic.iframe ? topic.iframe : `<img src="${topic.video}" alt="${topic.title}"><div class="play-button">‚ñ∂</div>`}
                    </div>
                    ${topic.description ? `<p class="topic-description">${topic.description}</p>` : ''}
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="openQuiz('${courseId}', '${topic.title}')">Autoevaluaci√≥n</button>
                        <button class="btn-secondary" onclick="openTutor('${courseId}', '${topic.title}')">Abrir Tutor GPT</button>
                    </div>
                </div>
            `).join('');
            if (window.MathJax && MathJax.typeset) { MathJax.typeset(); }
        }

        // Volver al dashboard
        function backToDashboard() {
            document.getElementById('course-detail-page').style.display = 'none';
            document.getElementById('dashboard-page').style.display = 'block';
        }

        // Abrir cuestionario
        
// ==== Banco de preguntas por curso/tema ====
// Puedes editar/a√±adir cada tema con EXACTAMENTE 5 preguntas.
// Formato: { q:'', options:['','','',''], answer: √≠ndiceCorrecto(0-3), feedback:'texto corto' }
const quizBank = {
  matematicas: {
    "Suma de Funciones": [
      { q: "Si $f(x)=2x$ y $g(x)=x^2$, entonces $(f+g)(2) =$ ?", options: ["6","8","10","12"], answer: 1, feedback: "Eval√∫a: $f(2)=4$, $g(2)=4$, suma $=8$." },
      { q: "El dominio de $(f+g)$ es:", options: ["Uni√≥n de dominios","Intersecci√≥n de dominios","Todo $\\mathbb{R}$","Ninguna"], answer: 1, feedback: "Para operaciones de funciones, el dominio es la intersecci√≥n." },
      { q: "Si $f(1)=3$ y $g(1)=-5$, entonces $(f+g)(1)=$", options: ["-2","2","8","-8"], answer: 0, feedback: "Suma directa de valores en el mismo $x$." },
      { q: "Sea $f(x)=x$ y $g(x)=\\sqrt{x}$, ¬øpara qu√© $x$ est√° definida $(f+g)(x)$?", options: ["$x>0$","$x\\ge0$","$x\\ne0$","$x<0$"], answer: 1, feedback: "Intersecci√≥n: $f$ dominio $\\mathbb{R}$, $g$ dominio $[0,\\infty)$ ‚Üí $[0,\\infty)$." },
      { q: "Si $f(x)=x^2$ y $g(x)=1$, entonces $(f+g)(x)$ es:", options: ["$x^2$","$x^2-1$","$x^2+1$","$2x^2$"], answer: 2, feedback: "Sumar una constante desplaza la funci√≥n hacia arriba." }
    ],
    "Resta de Funciones": [
      { q: "Si $f(x)=x^2$ y $g(x)=x$, $(f-g)(3)=$", options: ["6","9","12","7"], answer: 0, feedback: "$9-3=6$." },
      { q: "El dominio de $(f-g)$ es:", options: ["Uni√≥n","Intersecci√≥n","Vac√≠o","Todo $\\mathbb{R}$"], answer: 1, feedback: "Mismo criterio que la suma." },
      { q: "Si $f$ y $g$ est√°n definidas en $A$ y $B$, el dominio de $(f-g)$ es:", options: ["$A\\cup B$","$A\\cap B$","$A-B$","$B-A$"], answer: 1, feedback: "Intersecci√≥n." },
      { q: "Si $f(x)=\\sqrt{x}$ y $g(x)=1$, dominio de $(f-g)$:", options: ["$x>0$","$x\\ge0$","$x\\ne0$","Todo $\\mathbb{R}$"], answer: 1, feedback: "Por $\\sqrt{x}$." },
      { q: "Si $f(2)=5$ y $g(2)=7$, $(f-g)(2)=$", options: ["2","-2","12","-12"], answer: 1, feedback: "Resta de valores puntuales." }
    ],
    "Multiplicaci√≥n de Funciones": [
      { q: "Definici√≥n: $(f\\cdot g)(x)$ es:", options: ["$f(x)+g(x)$","$f(x)-g(x)$","$f(x)‚Ä¢g(x)$","$\\dfrac{f(x)}{g(x)}$"], answer: 2, feedback: "Producto punto a punto." },
      { q: "Si $f(x)=x-2$ y $g(x)=\\sqrt{x}$, dominio de $(f\\cdot g)$:", options: ["$\\mathbb{R}$","$x\\ge0$","$x>2$","$x\\ne0$"], answer: 1, feedback: "Intersecci√≥n: $f$ en $\mathbb{R}$ y $g$ en $[0,\infty)$ ‚Üí $[0,\infty)$." },
      { q: "Si $f(a)=0$ para alg√∫n $a$, entonces $(f\\cdot g)(a)$ es:", options: ["$g(a)$","$0$","$1$","Indefinido"], answer: 1, feedback: "Cualquier valor por cero es cero." },
      { q: "Continuidad: si $f$ y $g$ son continuas en $x_0$, entonces $(f\\cdot g)$ es:", options: ["Siempre discontinua","Continua en $x_0$","Solo si $f(x_0)\\ne0$","Solo si $g(x_0)\\ne0$"], answer: 1, feedback: "Producto de funciones continuas es continua." },
      { q: "Si $f(x)=x$ y $g(x)=x+1$, $(f\\cdot g)(x)$ es:", options: ["$x+1$","$x^2+x$","$x^2-1$","$2x$"], answer: 1, feedback: "Multiplica polinomios: $x(x+1)=x^2+x$." }
    ],
    "Divisi√≥n de Funciones": [
      { q: "Definici√≥n correcta de $\\left(\\dfrac{f}{g}\\right)(x)$:", options: ["$f(x)+g(x)$","$f(x)-g(x)$","$\\dfrac{f(x)}{g(x)}$","$f(x)g(x)$"], answer: 2, feedback: "Cociente punto a punto." },
      { q: "Restricci√≥n clave del dominio:", options: ["$f(x)\ne0$","$g(x)\\ne0$","$f(x),g(x)$ definidas","Ninguna"], answer: 1, feedback: "No se puede dividir entre cero." },
      { q: "Si $f(x)=x^2-1$ y $g(x)=x-1$, entonces $\\dfrac{f(x)}{g(x)}=$", options: ["$x+1$","$x-1$","$x^2$","$1$"], answer: 0, feedback: "Factoriza $x^2-1=(x-1)(x+1)$ ‚Üí simplifica a $x+1$, con $x\ne1$." },
      { q: "Posibles as√≠ntotas verticales ocurren cuando:", options: ["$f(x)=0$","$g(x)=0$","$f(x)=g(x)$","$x=0$"], answer: 1, feedback: "Ceros del denominador (si no se cancelan) producen as√≠ntotas." },
      { q: "Dominio de $\\dfrac{x}{\\sqrt{x-2}}$ (en reales):", options: ["$x>2$","$x\\ge2$","$x\\ne2$","$x\\in\\mathbb{R}$"], answer: 0, feedback: "$x-2>0\\Rightarrow x>2$; adem√°s el denominador no puede ser 0." }
    ],
    "Dominio y Rango de Funciones": [
      { q: "Dominio de $f(x)=\\sqrt{x-1}$:", options: ["$x>1$","$x\\ge1$","$x\\ne1$","$\\mathbb{R}$"], answer: 1, feedback: "El radicando debe ser $\ge0$." },
      { q: "Rango de $f(x)=x^2$:", options: ["$\\mathbb{R}$","$(-\\infty,0]$","$[0,\\infty)$","$[1,\\infty)$"], answer: 2, feedback: "Par√°bola abre hacia arriba, m√≠nimo en 0." },
      { q: "Dominio de $f(x)=\\dfrac{1}{x}$:", options: ["$\\mathbb{R}$","$\\mathbb{R}-\\{0\\}$","$(-\\infty,0)$","$(0,\\infty)$"], answer: 1, feedback: "No definido en $x=0$." },
      { q: "Rango de $f(x)=\\dfrac{1}{x}$:", options: ["$\\mathbb{R}$","$\\mathbb{R}-\\{0\\}$","$(-\\infty,0)$","$(0,\\infty)$"], answer: 1, feedback: "Nunca toma el valor 0." },
      { q: "Si $f(x)=x+1$, su dominio y rango (reales) son:", options: ["$\\mathbb{R}$ y $\\mathbb{R}$","$\\mathbb{R}$ y $[0,\\infty)$","$[0,\\infty)$ y $\\mathbb{R}$","$(-\\infty,1]$ y $\\mathbb{R}$"], answer: 0, feedback: "Lineal sin restricciones ‚Üí todo real a todo real." }
    ]
  },
  fisica: {
    "Momento de fuerza o torque": [
      { q: "El torque se define como:", options: ["$\\vec{F}\\cdot\\vec{r}$","$\\vec{r}\\times\\vec{F}$","$\\vec{F}\\times\\vec{v}$","$m\\vec{a}$"], answer: 1, feedback: "Por definici√≥n $\\vec{\\tau}=\\vec{r}\\times\\vec{F}$." },
      { q: "Unidad SI del torque:", options: ["N","N/m","N¬∑m","J/s"], answer: 2, feedback: "Newton por metro." },
      { q: "Si $\\vec{F}$ es colineal con $\\vec{r}$, entonces $\\tau$ es:", options: ["M√°ximo","M√≠nimo no nulo","Cero","Indeterminado"], answer: 2, feedback: "Producto vectorial nulo si vectores paralelos." },
      { q: "Para maximizar $\\tau$ mantenemos el √°ngulo cercano a:", options: ["$0^\\circ$","$45^\\circ$","$90^\\circ$","$180^\\circ$"], answer: 2, feedback: "Seno m√°ximo a 90¬∞." },
      { q: "El brazo de palanca correcto es:", options: ["Distancia a la l√≠nea de acci√≥n","Distancia al punto cualquiera","Radio del cuerpo","Masa"], answer: 0, feedback: "Distancia perpendicular a la l√≠nea de acci√≥n." }
    ],
    "Segunda condici√≥n de equilibrio": [
      { q: "La segunda condici√≥n de equilibrio establece que:", options: ["$\\sum \\vec{F}=\\vec{0}$","$\\sum \\tau=0$","$\\sum m=0$","$\\sum v=0$"], answer: 1, feedback: "Equilibrio rotacional." },
      { q: "Si $\\sum\\tau\\neq0$, el cuerpo:", options: ["Se traslada","Rota con aceleraci√≥n angular","Permanece en reposo","Se acelera linealmente"], answer: 1, feedback: "Torque neto ‚â† 0 produce rotaci√≥n." },
      { q: "Elegir el punto de giro al aplicar $\\sum\\tau=0$ es √∫til para:", options: ["Cambiar la masa","Eliminar fuerzas desconocidas que pasan por el pivote","Aumentar el torque","Medir energ√≠a"], answer: 1, feedback: "Fuerzas que pasan por el pivote no generan momento." },
      { q: "En equilibrio total se cumple:", options: ["Solo $\\sum\\tau=0$","Solo $\\sum\\vec{F}=\\vec{0}$","Ambas condiciones","Ninguna"], answer: 2, feedback: "Equilibrio traslacional y rotacional." },
      { q: "El signo del torque depende de:", options: ["Magnitud de la fuerza","Elecci√≥n de sentido horario/antihorario","Sistema de unidades","Masa"], answer: 1, feedback: "Convenci√≥n de signos." }
    ],
    "Ejercicio: segunda condici√≥n de equilibrio": [
      { q: "Una fuerza $F_1=10\\,\\text{N}$ a $d_1=0.3\\,\\text{m}$ compensa a $F_2$ a $d_2=0.2\\,\\text{m}$. Si torques opuestos, $F_2$ es:", options: ["5 N","10 N","12 N","15 N"], answer: 3, feedback: "$F_1d_1=F_2d_2\\Rightarrow F_2=10\\cdot0.3/0.2=15$ N." },
      { q: "Si $F=40\\,\\text{N}$ y $d=0.5\\,\\text{m}$, el torque es:", options: ["10 N¬∑m","20 N¬∑m","40 N¬∑m","80 N¬∑m"], answer: 1, feedback: "$\\tau=Fd=20$ N¬∑m." },
      { q: "Para anular el torque de 25 N¬∑m con $d=0.5$ m se requiere $F$ de:", options: ["25 N","50 N","12.5 N","5 N"], answer: 1, feedback: "$F=\\tau/d=25/0.5=50$ N, sentido opuesto." },
      { q: "Si una fuerza pasa por el pivote, su torque es:", options: ["M√°ximo","Igual al peso","Cero","Indeterminado"], answer: 2, feedback: "Brazo de palanca nulo." },
      { q: "En una regla horizontal, el peso propio se aplica en:", options: ["Un extremo","Centro de masa","Donde se sostenga","No aplica"], answer: 1, feedback: "Centro geom√©trico si homog√©nea." }
    ],
    "Equilibrio total de cuerpos r√≠gidos": [
      { q: "Equilibrio total implica:", options: ["$\\sum\\vec{F}=\\vec{0}$","$\\sum\\tau=0$","Ambas","Ninguna"], answer: 2, feedback: "Sin traslaci√≥n ni rotaci√≥n." },
      { q: "Si $\\sum\\vec{F}\\neq\\vec{0}$ pero $\\sum\\tau=0$:", options: ["Traslaci√≥n sin rotaci√≥n","Rotaci√≥n sin traslaci√≥n","Reposo","Imposible"], answer: 0, feedback: "Fuerza neta ‚â† 0 acelera linealmente." },
      { q: "Una viga con dos apoyos y carga central produce reacciones:", options: ["Desiguales siempre","Iguales","Cero","Indeterminadas"], answer: 1, feedback: "Simetr√≠a ‚Üí reacciones iguales." },
      { q: "Para resolver reacciones es √∫til tomar momentos respecto a:", options: ["El centro de masa","Un extremo","Un punto donde canceles una inc√≥gnita","Cualquier punto con fricci√≥n"], answer: 2, feedback: "Elimina inc√≥gnitas que pasan por el punto." },
      { q: "Las ecuaciones de equilibrio en 2D son:", options: ["2","3","4","5"], answer: 1, feedback: "$\\sum F_x=0, \\sum F_y=0, \\sum \\tau=0$." }
    ],
    "Ejercicio de equilibrio total": [
      { q: "Para una viga de longitud $L$ con peso $W$ centrado, las reacciones $R_A$ y $R_B$ son:", options: ["$W$ y $0$","$0$ y $W$","$W/2$ y $W/2$","Indeterminadas"], answer: 2, feedback: "Simetr√≠a y $\\sum F_y=0$." },
      { q: "Si adem√°s cuelga una masa $P$ en el extremo B, entonces $R_B$:", options: ["Disminuye","Aumenta","No cambia","Se vuelve negativa"], answer: 1, feedback: "Momento adicional en B." },
      { q: "Tomando momentos en A, $R_B L = W\\,\\dfrac{L}{2}$ ‚áí $R_B$:", options: ["$W$","$W/2$","$W/4$","$2W$"], answer: 1, feedback: "Resultado cl√°sico con carga centrada." },
      { q: "Si $R_A=300$ N y $R_B=500$ N, entonces $W$:", options: ["300 N","500 N","800 N","200 N"], answer: 2, feedback: "Equilibrio vertical: $R_A+R_B=W$." },
      { q: "Un sistema est√°tico con 3 fuerzas no paralelas en equilibrio requiere que sus l√≠neas de acci√≥n:", options: ["Sean paralelas","Concurran en un punto","Sean horizontales","Ninguna"], answer: 1, feedback: "Criterio de concurrencia." }
    ]
  },
  quimica: {
    "Leyes Ponderales ‚Äì Ley de Lavoisier": [
      { q: "La Ley de Lavoisier establece que:", options: ["La masa se crea con energ√≠a","La masa total se conserva","El volumen se conserva","La energ√≠a no se conserva"], answer: 1, feedback: "Masa de reactivos = masa de productos." },
      { q: "En $2\\,\\mathrm{H_2}+\\mathrm{O_2}\\to2\,\\mathrm{H_2O}$, si reaccionan 4 g de H2 con 32 g de O2, la masa de productos es:", options: ["32 g","36 g","28 g","4 g"], answer: 1, feedback: "Conservaci√≥n: 4+32=36 g." },
      { q: "En un sistema abierto puede no observarse masa constante porque:", options: ["Se viola la ley","Hay p√©rdidas/ganancias de materia","La reacci√≥n no ocurre","Se crea materia"], answer: 1, feedback: "Entrada/salida de materia altera la medici√≥n." },
      { q: "Para verificar la ley experimentalmente conviene usar:", options: ["Recipiente cerrado","Recipiente abierto","Solo masa de productos","Solo masa de reactivos"], answer: 0, feedback: "A√≠sla el sistema." },
      { q: "Si se forma gas y escapa, la masa medida de productos ser√°:", options: ["Mayor","Igual","Menor","Impredecible"], answer: 2, feedback: "P√©rdida de masa aparente por escape de gas." }
    ],
    "Leyes Ponderales ‚Äì Ley de Dalton (proporciones m√∫ltiples)": [
      { q: "La Ley de Dalton indica que las masas que se combinan para formar distintos compuestos guardan:", options: ["Relaciones continuas","Proporciones de enteros peque√±os","Relaci√≥n exponencial","No hay regla"], answer: 1, feedback: "Proporciones simples." },
      { q: "C y O forman CO (12:16) y CO2 (12:32). La raz√≥n de O es:", options: ["1:1","1:2","2:1","3:2"], answer: 1, feedback: "16:32 = 1:2." },
      { q: "Si 14 g de N se combinan con 16 g de O (NO) y 32 g de O (NO2), la raz√≥n de masas de O es:", options: ["1:1","1:2","2:1","1:3"], answer: 1, feedback: "16:32 = 1:2 ‚Üí enteros peque√±os." },
      { q: "La ley ayuda a:", options: ["Definir f√≥rmulas emp√≠ricas","Calcular densidad","Medir presi√≥n","Determinar pH"], answer: 0, feedback: "Base para estequiometr√≠a." },
      { q: "Para aplicar la ley se necesita:", options: ["Temperatura constante","Mismas condiciones de presi√≥n","Una cantidad fija de uno de los elementos","Catalizador"], answer: 2, feedback: "Comparaci√≥n con base fija." }
    ],
    "Leyes Ponderales ‚Äì Ley de Proust (proporciones definidas)": [
      { q: "La Ley de Proust establece que un compuesto puro tiene:", options: ["Composici√≥n variable","Proporci√≥n en masa constante","Solo un elemento","Geometr√≠a fija"], answer: 1, feedback: "Independiente del origen." },
      { q: "En agua, la relaci√≥n de masas H:O es:", options: ["1:1","1:2","1:8","2:1"], answer: 2, feedback: "2√ó1 : 16 ‚Üí 1:8." },
      { q: "Si una muestra de NaCl de Per√∫ y otra de M√©xico se analizan, su % en masa de Na y Cl ser√°:", options: ["Distinto","Igual","Depende del m√©todo","Indefinido"], answer: 1, feedback: "Misma proporci√≥n en masa." },
      { q: "Ejemplo que contradice Proust:", options: ["Mezcla de arena y sal","Agua destilada","CO2 puro","NaCl puro"], answer: 0, feedback: "Mezclas no son compuestos puros." },
      { q: "Para verificar Proust se requiere:", options: ["Medir moles de gas","Determinar % en masa de elementos","Medir energ√≠a liberada","Colorimetr√≠a"], answer: 1, feedback: "Composici√≥n constante." }
    ],
    "Reactivo limitante y en exceso": [
      { q: "El reactivo limitante es el que:", options: ["Se consume al final","Se consume primero","Tiene mayor masa","Es m√°s caro"], answer: 1, feedback: "Determina la cantidad m√°xima de producto." },
      { q: "Pasos: calcular moles, dividir por coeficiente y:", options: ["Multiplicar por masa molar","Elegir el mayor","Elegir el menor","Sumar moles"], answer: 2, feedback: "El menor indica el limitante." },
      { q: "En $2H_2+O_2\\to2H_2O$, con 4 mol H2 y 3 mol O2, el limitante es:", options: ["$H_2$","$O_2$","Ninguno","Ambos"], answer: 0, feedback: "$4/2=2$ vs $3/1=3$ ‚Üí menor: H2." },
      { q: "Si el limitante produce 5 mol de producto, los moles m√°ximos de producto son:", options: ["5 mol","10 mol","Depende del rendimiento","0 mol"], answer: 0, feedback: "En rendimiento te√≥rico." },
      { q: "El reactivo en exceso es el que:", options: ["Sobran moles sin reaccionar","Se evapora","No participa","Se descompone"], answer: 0, feedback: "Queda sin consumirse totalmente." }
    ],
    "Ejercicio ‚Äì Leyes Ponderales": [
      { q: "Si 10 g de A reaccionan con 20 g de B para dar 25 g de AB y 5 g se pierden como gas, ¬øse viola Lavoisier?", options: ["S√≠","No, sistema abierto","S√≠, porque falta masa","No, porque 10=20"], answer: 1, feedback: "Fuga de gas ‚Üí p√©rdida aparente en sistema abierto." },
      { q: "Dos compuestos de X e Y: X1Y1 (10 g X con 5 g Y) y X1Y2 (10 g X con 10 g Y). Raz√≥n de Y:", options: ["1:1","1:2","2:1","1:3"], answer: 1, feedback: "5:10=1:2 ‚Üí Dalton." },
      { q: "Un compuesto XY siempre presenta 40% X y 60% Y en masa. Esto ejemplifica:", options: ["Dalton","Proust","Lavoisier","Ideal de gases"], answer: 1, feedback: "Proporciones definidas." },
      { q: "Si 18 g de agua se descomponen, masas de H2 y O2 son (en g):", options: ["2 y 16","1 y 17","9 y 9","4 y 14"], answer: 0, feedback: "1:8 en masa, total 18 g." },
      { q: "Para confirmar limitante, se usa la relaci√≥n:", options: ["$n/coef$","$m\\cdot M$","$M/n$","$m+n$"], answer: 0, feedback: "Comparar $n/\nu$ (coef estequiom√©trico)." }
    ]
  }
};

let __currentQuiz = { courseId: null, topicTitle: null, graded: false, answers: [], result: null };

function openQuiz(courseId, topicTitle) {
  __currentQuiz = { courseId, topicTitle, graded: false, answers: [], result: null };
  const bank = quizBank[courseId] && quizBank[courseId][topicTitle];
  document.getElementById('quiz-modal').style.display = 'flex';
  document.getElementById('quiz-modal-title').textContent = `Autoevaluaci√≥n ‚Äì ${topicTitle}`;
  const body = document.getElementById('quiz-body');

  if (!bank) {
    body.innerHTML = `<div class="quiz-summary">
        <h4>No hay preguntas configuradas para este tema.</h4>
        <p class="muted">Pide al administrador que agregue 5 preguntas para <b>${topicTitle}</b> en <code>quizBank</code>.</p>
      </div>`;
    if (window.MathJax && MathJax.typeset) { MathJax.typeset(); }
    return;
  }
  body.innerHTML = bank.map((item, i) => `
    <div class="quiz-question" data-index="${i}">
      <div class="quiz-badge">Pregunta ${i+1}/5</div>
      <h4>${item.q}</h4>
      <div class="quiz-options">
        ${item.options.map((opt, j) => `
          <label class="quiz-option">
            <input type="radio" name="q${i}" value="${j}"/>
            <span>${opt}</span>
          </label>
        `).join('')}
      </div>
      <div class="quiz-feedback muted" id="fb-${i}"></div>
    </div>
  `).join('');
  if (window.MathJax && MathJax.typeset) { MathJax.typeset(); }
}

function gradeQuiz() {
  const bank = quizBank[__currentQuiz.courseId] && quizBank[__currentQuiz.courseId][__currentQuiz.topicTitle];
  if (!bank) return;
  const answers = [];
  let correct = 0;

  bank.forEach((item, i) => {
    const sel = document.querySelector(`input[name="q${i}"]:checked`);
    const chosen = sel ? Number(sel.value) : null;
    answers.push(chosen);
    const fb = document.getElementById(`fb-${i}`);
    if (chosen === null) {
      fb.innerHTML = `<span class="incorrect">Sin respuesta.</span> <span class="muted">${item.feedback}</span>`;
    } else if (chosen === item.answer) {
      fb.innerHTML = `<span class="correct">Correcto ‚úî</span>`;
      correct++;
    } else {
      fb.innerHTML = `<span class="incorrect">Incorrecto ‚úò</span> ‚Äî <span class="muted">${item.feedback}</span>`;
    }
  });

  const result = { total: bank.length, correct, wrong: bank.length - correct, answers };
  __currentQuiz.graded = true;
  __currentQuiz.answers = answers;
  __currentQuiz.result = result;
  showSummary(); // mostramos resumen inmediatamente despu√©s de enviar
}

function showSummary() {
  const bank = quizBank[__currentQuiz.courseId] && quizBank[__currentQuiz.courseId][__currentQuiz.topicTitle];
  const body = document.getElementById('quiz-body');
  if (!bank) return;
  const r = __currentQuiz.result || { total: bank.length, correct: 0, wrong: bank.length, answers: [] };

  const list = bank.map((item, i) => {
    const user = r.answers[i];
    const status = user === item.answer ? 'correcto' : (user == null ? 'sin respuesta' : 'incorrecto');
    const cls = user === item.answer ? 'correct' : 'incorrect';
    const expected = item.options[item.answer];
    return `<li>
      <b>Pregunta ${i+1}:</b> <span class="${cls}">${status}</span>
      <div class="quiz-feedback muted">Respuesta correcta: <em>${expected}</em>. ${user === item.answer ? '' : item.feedback}</div>
    </li>`;
  }).join('');

  const html = `
    <div class="quiz-summary">
      <h4>Resumen de resultados</h4>
      <p><b>Aciertos:</b> ${r.correct}/${r.total} &nbsp;|&nbsp; <b>Errores:</b> ${r.wrong}</p>
      <ol style="margin-left: 1rem; display:grid; gap:.5rem;">${list}</ol>
    </div>
  `;

  // Insertamos/actualizamos al principio del body del modal
  body.insertAdjacentHTML('afterbegin', html);
  if (window.MathJax && MathJax.typeset) { MathJax.typeset(); }
}

function resetQuiz() {
  openQuiz(__currentQuiz.courseId, __currentQuiz.topicTitle);
}

function closeQuiz() {
  document.getElementById('quiz-modal').style.display = 'none';
}

        // Abrir tutor inteligente
        function openTutor(courseId, topicTitle) {
		  const url = tutorLinks[courseId];
		  if (!url) {
			alert('No hay tutor configurado para este curso.');
			return;
		  }
		  window.open(url, '_blank', 'noopener,noreferrer');
		}

        // Cerrar sesi√≥n
        function logout() {
            if (confirm('¬øEst√°s seguro que deseas cerrar sesi√≥n?')) {
                // Ocultar p√°ginas
                document.getElementById('dashboard-page').style.display = 'none';
                document.getElementById('course-detail-page').style.display = 'none';
                
                // Limpiar formularios
                document.getElementById('login-form').reset();
                
                // Mostrar p√°gina de login
                document.getElementById('login-page').style.display = 'flex';
            }
        }
    
/* ====== ENDPOINTS: reemplaza por tus Web Apps de Apps Script ====== */
const ADMIN_ENDPOINTS = {
  actividad: 'https://docs.google.com/spreadsheets/d/1UX8IgNRXWDuRZtDg2SR-AHV6SUYjeyNiQECrguiZcRc/edit?usp=sharing',
  resultados: {
    mate: 'https://docs.google.com/spreadsheets/d/10EFqxfZG2nCvijNtRslG4UzkxDKKWsrgRYMo2O6GFhE/edit?usp=sharing',
    fisi: 'https://docs.google.com/spreadsheets/d/10EFqxfZG2nCvijNtRslG4UzkxDKKWsrgRYMo2O6GFhE/edit?usp=sharing',
    quim: 'https://docs.google.com/spreadsheets/d/10EFqxfZG2nCvijNtRslG4UzkxDKKWsrgRYMo2O6GFhE/edit?usp=sharing'
  }
};

/* Inyecta enlaces en todos los men√∫s Acciones presentes en el DOM */
function initAdminMenus() {
  document.querySelectorAll('.admin-actions-menu').forEach(menu => {
    const aActividad = menu.querySelector('a[data-link="actividad"]');
    const aMate = menu.querySelector('a[data-link="mate"]');
    const aFisi = menu.querySelector('a[data-link="fisi"]');
    const aQuim = menu.querySelector('a[data-link="quim"]');

    if (aActividad) aActividad.href = ADMIN_ENDPOINTS.actividad;
    if (aMate) aMate.href = ADMIN_ENDPOINTS.resultados.mate;
    if (aFisi) aFisi.href = ADMIN_ENDPOINTS.resultados.fisi;
    if (aQuim) aQuim.href = ADMIN_ENDPOINTS.resultados.quim;
  });
}

/* Muestra/Oculta men√∫s Acciones seg√∫n rol */
function setAdminMenusVisible(visible) {
  document.querySelectorAll('.admin-actions-menu')
    .forEach(m => m.style.display = visible ? 'inline-block' : 'none');
}

/* Al cargar el documento, inicializa men√∫s (por si ya est√°s en dashboard) */
document.addEventListener('DOMContentLoaded', () => {
  initAdminMenus();
  // Intento de leer rol si ya existiera
  try {
    const roleStored = localStorage.getItem('role');
    if (roleStored === 'admin') setAdminMenusVisible(true);
  } catch(e){}
});

/* Hook tras login (sin alterar tu l√≥gica) */
(function wireAdminMenusAfterLogin(){
  const form = document.getElementById('login-form');
  if (!form) return;
  form.addEventListener('submit', () => {
    setTimeout(() => {
      const isAdmin = (typeof currentRole !== 'undefined' && currentRole === 'admin') || localStorage.getItem('role') === 'admin';
      if (isAdmin) {
        initAdminMenus();
        setAdminMenusVisible(true);
      } else {
        setAdminMenusVisible(false);
      }
    }, 60);
  });
})();

/* Hook al entrar a un curso (la p√°gina de curso tiene otro header) */
const __originalShowCourse = showCourse;
showCourse = function(courseId){
  __originalShowCourse(courseId);
  const isAdmin = (typeof currentRole !== 'undefined' && currentRole === 'admin') || localStorage.getItem('role') === 'admin';
  initAdminMenus();          // el header de curso se inyecta din√°micamente
  setAdminMenusVisible(isAdmin);
};
</script>

	<script>
	  // Toggle de modo oscuro con persistencia + cambio de icono
	  const themeButtons = document.querySelectorAll('.theme-toggle');
	  const themeIcons = document.querySelectorAll('.theme-toggle img');

	  // Aplica tema + iconos + persistencia
	  function applyTheme(isDark) {
		document.body.classList.toggle('dark-mode', isDark);
		themeIcons.forEach(img => { img.src = isDark ? 'oscuro.png' : 'claro.png'; });
		localStorage.setItem('smartstudy-theme', isDark ? 'dark' : 'light');
	  }

	  // Estado guardado
	  const saved = localStorage.getItem('smartstudy-theme');
	  applyTheme(saved === 'dark');

	  // Click en cualquiera de los botones
	  themeButtons.forEach(btn => {
		btn.addEventListener('click', () => {
		  const isDark = !document.body.classList.contains('dark-mode');
		  applyTheme(isDark);
		});
	  });
	</script>

	

<!-- Modal Autoevaluaci√≥n -->
<div id="quiz-modal" aria-hidden="true">
  <div class="quiz-card" role="dialog" aria-modal="true" aria-labelledby="quiz-modal-title">
    <div class="quiz-header">
      <div class="quiz-title" id="quiz-modal-title">Autoevaluaci√≥n</div>
      <button class="quiz-close" onclick="closeQuiz()" aria-label="Cerrar">√ó</button>
    </div>
    <div class="quiz-body" id="quiz-body">
      <!-- contenido din√°mico -->
    </div>
    <div class="quiz-footer">
      <button class="btn-quiz secondary" onclick="resetQuiz()">Reiniciar</button>
      <button class="btn-quiz primary" onclick="gradeQuiz()">Enviar respuestas</button>
    </div>
  </div>
</div>


<!-- === SmartStudy activity tracking hooks (auto-insert) === -->
<script>
(function(){
  const form = document.getElementById('login-form');
  if (form) {
    form.addEventListener('submit', function(){
      try {
        const role = window.currentRole || (document.getElementById('admin-fields')?.style.display === 'block' ? 'admin' : 'student');
        if (role === 'student') {
          const name = (document.getElementById('student-name')?.value || '').trim();
          const code = (document.getElementById('student-code')?.value || '').trim();
          if (name && code) {
            window.SS_currentUser = window.SS_currentUser || { code: "", name: "", course: "" };
            SS_currentUser.name = name;
            SS_currentUser.code = code;
            SS_currentUser.course = '';
            SS_track('login');
          }
        }
      } catch(e) { console.warn(e); }
    }, { capture: true });
  }

  if (typeof window.showCourse === 'function') {
    const _showCourse = window.showCourse;
    window.showCourse = function(courseId){
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        window.SS_currentUser = window.SS_currentUser || { code: "", name: "", course: "" };
        SS_currentUser.course = cname;
        SS_track(`open_course:${courseId}`, { course: cname });
      } catch(e) { console.warn(e); }
      return _showCourse.apply(this, arguments);
    };
  }

  if (typeof window.openQuiz === 'function') {
    const _openQuiz = window.openQuiz;
    window.openQuiz = function(courseId, topicTitle){
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_quiz:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
      return _openQuiz.apply(this, arguments);
    };
  } else {
    window.openQuiz = function(courseId, topicTitle){
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_quiz:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
    };
  }

  if (typeof window.openTutor === 'function') {
    const _openTutor = window.openTutor;
    window.openTutor = function(courseId, topicTitle){
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_tutor:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
      return _openTutor.apply(this, arguments);
    };
  } else {
    window.openTutor = function(courseId, topicTitle){
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_tutor:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
    };
  }
})();
</script>


<!-- === SmartStudy activity tracking hooks === -->
<script>
(function(){
  // Hook login submit for student role
  const form = document.getElementById('login-form');
  if (form) {
    form.addEventListener('submit', function() {
      try {
        const role = window.currentRole || (document.getElementById('admin-fields')?.style.display === 'block' ? 'admin' : 'student');
        if (role === 'student') {
          const name = (document.getElementById('student-name')?.value || '').trim();
          const code = (document.getElementById('student-code')?.value || '').trim();
          if (name && code) {
            window.SS_currentUser = window.SS_currentUser || { code: "", name: "", course: "" };
            SS_currentUser.name = name;
            SS_currentUser.code = code;
            SS_currentUser.course = '';
            SS_track('login');
          }
        }
      } catch(e) { console.warn(e); }
    }, { capture: true });
  }

  // Wrap showCourse to capture course open + set current course
  if (typeof window.showCourse === 'function') {
    const _showCourse = window.showCourse;
    window.showCourse = function(courseId) {
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        window.SS_currentUser = window.SS_currentUser || { code: "", name: "", course: "" };
        SS_currentUser.course = cname;
        SS_track(`open_course:${courseId}`, { course: cname });
      } catch(e) { console.warn(e); }
      return _showCourse.apply(this, arguments);
    };
  }

  // Wrap openQuiz
  if (typeof window.openQuiz === 'function') {
    const _openQuiz = window.openQuiz;
    window.openQuiz = function(courseId, topicTitle) {
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_quiz:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
      return _openQuiz.apply(this, arguments);
    };
  } else {
    window.openQuiz = function(courseId, topicTitle) {
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_quiz:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
    };
  }

  // Wrap openTutor
  if (typeof window.openTutor === 'function') {
    const _openTutor = window.openTutor;
    window.openTutor = function(courseId, topicTitle) {
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_tutor:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
      return _openTutor.apply(this, arguments);
    };
  } else {
    window.openTutor = function(courseId, topicTitle) {
      try {
        const cname = (window.coursesContent && window.coursesContent[courseId] && window.coursesContent[courseId].name) ? window.coursesContent[courseId].name : courseId;
        SS_track(`open_tutor:${topicTitle}`, { course: cname });
      } catch(e) { console.warn(e); }
    };
  }
})();
</script>


<!-- === SmartStudy Quiz Results API (final) === -->
<img src="https://script.google.com/macros/s/AKfycbwrWnsaiRVjeQqY7fRsoyaQ-M3zS3A-YQl1EeUjEUtWxgmv-2nvIKIjkSDvjxi6n0ywqg/exec?action=health&cb=1" alt="" style="width:1px;height:1px;opacity:0;position:absolute;pointer-events:none" aria-hidden="true" referrerpolicy="no-referrer">
<script>
(function(){
  const ENDPOINT = "https://script.google.com/macros/s/AKfycbwrWnsaiRVjeQqY7fRsoyaQ-M3zS3A-YQl1EeUjEUtWxgmv-2nvIKIjkSDvjxi6n0ywqg/exec";
  const TOKEN = "SmartStudy_QUIZ_TOKEN_2025";

  // Mark start time when opening quiz
  if (typeof window.openQuiz === 'function') {
    const _openQuiz = window.openQuiz;
    window.openQuiz = function(courseId, topicTitle){
      const r = _openQuiz.apply(this, arguments);
      try {
        window.__currentQuiz = window.__currentQuiz || {};
        __currentQuiz._tStart = Date.now();
        __currentQuiz.courseId = courseId;
        __currentQuiz.topicTitle = topicTitle;
      } catch(e){}
      return r;
    }
  }

  function getBank(){
    try {
      const cid = __currentQuiz && __currentQuiz.courseId;
      const t = __currentQuiz && __currentQuiz.topicTitle;
      return (quizBank && quizBank[cid] && quizBank[cid][t]) ? quizBank[cid][t] : null;
    } catch(e){ return null; }
  }

  function toStr(v){ return (v===undefined || v===null) ? '' : String(v); }

  function sendResults(){
    const bank = getBank();
    if (!bank) return;
    const answers = (__currentQuiz && Array.isArray(__currentQuiz.answers)) ? __currentQuiz.answers : [];
    const result = (__currentQuiz && __currentQuiz.result) ? __currentQuiz.result : { total: bank.length, correct: 0, wrong: bank.length, answers };
    const fechaISO = new Date().toISOString();
    const attemptId = [toStr(__currentQuiz.courseId), toStr(__currentQuiz.topicTitle), toStr((window.SS_currentUser&&SS_currentUser.code)||'anon'), fechaISO].join("::");
    const codigo = (window.SS_currentUser && SS_currentUser.code) || '';
    const nombre = (window.SS_currentUser && SS_currentUser.name) || '';
    const cursoLabel = (window.SS_currentUser && SS_currentUser.course) || toStr(__currentQuiz.courseId);
    const tema = toStr(__currentQuiz.topicTitle);
    const ua = navigator.userAgent || '';
    // per item
    bank.forEach((item, i)=>{
      const chosenIdx = answers[i];
      const payload = new URLSearchParams();
      payload.set('action','submitItem');
      payload.set('token', TOKEN);
      payload.set('attemptId', attemptId);
      payload.set('fechaISO', fechaISO);
      payload.set('codigo', codigo);
      payload.set('nombre', nombre);
      payload.set('curso', cursoLabel);
      payload.set('tema', tema);
      payload.set('numeroPregunta', String(i+1));
      payload.set('enunciado', toStr(item.q));
      payload.set('opcionMarcada', toStr(chosenIdx==null?'':(item.options[chosenIdx]||'')));
      payload.set('opcionCorrecta', toStr((item.options[item.answer]||'')));
      payload.set('esCorrecta', String(chosenIdx===item.answer));
      payload.set('tiempoMs','0');
      payload.set('userAgent', ua);
      fetch(ENDPOINT, {
        method:'POST',
        headers:{'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8'},
        body:payload.toString()
      }).catch(()=>{});
    });
    // summary
    const total = result.total || bank.length;
    const aciertos = result.correct || 0;
    const errores = result.wrong || Math.max(0,total-aciertos);
    const porcentaje = total ? Math.round((aciertos/total)*100) : 0;
    const duracionMs = Math.max(0, Date.now() - ((__currentQuiz&&__currentQuiz._tStart)||Date.now()));
    const payload2 = new URLSearchParams();
    payload2.set('action','finalizeAttempt');
    payload2.set('token', TOKEN);
    payload2.set('attemptId', attemptId);
    payload2.set('fechaISO', fechaISO);
    payload2.set('codigo', codigo);
    payload2.set('nombre', nombre);
    payload2.set('curso', cursoLabel);
    payload2.set('tema', tema);
    payload2.set('total', String(total));
    payload2.set('aciertos', String(aciertos));
    payload2.set('errores', String(errores));
    payload2.set('porcentaje', String(porcentaje));
    payload2.set('duracionMs', String(duracionMs));
    payload2.set('detalleJSON', JSON.stringify(answers));
    payload2.set('userAgent', ua);
    fetch(ENDPOINT, {
      method:'POST',
      headers:{'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8'},
      body:payload2.toString()
    }).catch(()=>{});
  }

  // primary: after gradeQuiz finishes
  if (typeof window.gradeQuiz === 'function') {
    const _gradeQuiz = window.gradeQuiz;
    window.gradeQuiz = function(){
      const r = _gradeQuiz.apply(this, arguments);
      try { sendResults(); } catch(e){}
      return r;
    }
  }

  // fallback: click listener on "Enviar respuestas"
  document.addEventListener('click', function(ev){
    const btn = ev.target.closest('button.btn-quiz.primary');
    if (!btn) return;
    setTimeout(()=>{ try { sendResults(); } catch(e){} }, 0);
  }, true);
})();
</script>

</body>
</html>







